<html><!-- InstanceBegin template="/Templates/informationObject.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<SCRIPT LANGUAGE="JavaScript" SRC="../tut.js"></SCRIPT>
<script language="JavaScript" src="../nav.js"></script>
<SCRIPT LANGUAGE="JavaScript">
 setPageTitle();
 setCookie();
  
// Drop down menu link- © Dynamic Drive (www.dynamicdrive.com)
// For full source code and 100's more DHTML scripts, visit http://www.dynamicdrive.com
// Credit MUST stay intact for use -->

</SCRIPT>

<!-- InstanceBeginEditable name="extrascript" -->
<SCRIPT LANGUAGE="JavaScript">
</SCRIPT>
<!-- InstanceEndEditable -->

<link rel="stylesheet" href="../tut.css">


<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
</HEAD>

<body marginheight="0" marginwidth="0" topmargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFF0">
<script>writeinformationObjectTopNav1();</script>
	  
	  <font color="#003399" size="3" face="Arial, Helvetica, sans-serif"><strong><!-- InstanceBeginEditable name="TopicTitle" -->Subsetting 
      Data by Using Noncorrelated Subqueries<!-- InstanceEndEditable --></strong></font> <!-- InstanceBeginEditable name="continued" --><font color="#003399" size="3" face="Arial, Helvetica, sans-serif">(continued)</font><!-- InstanceEndEditable -->
	  
<script>writeinformationObjectTopNav2();</script>
<br>
<center>
  <!-- InstanceBeginEditable name="content" --> 
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td><h2>Using Multiple-Value Noncorrelated Subqueries</h2>
        <p>Some subqueries are <strong>multiple-value subqueries</strong>: they 
          return more than one value (row) to the outer query. If your noncorrelated 
          subquery might return a value for more than one row, be sure to use 
          one of the following operators in the WHERE or HAVING clause that can 
          handle multiple values:</p>
        <ul>
          <li>the conditional operator IN</li>
          <li>a comparison operator that is modified by ANY or ALL</li>
          <li> the conditional operator EXISTS. </li>
        </ul></td>
    </tr>
  </table>
  <table width="85%" border="0" align="center" cellpadding="2" cellspacing="0">
    <tr> 
      <td valign="top" width="41"><img src="../navimages/alert.gif" width="37" height="32" alt="Caution"></td>
      <td valign="top"><p>If you create a noncorrelated subquery that returns 
          multiple values, but the WHERE or HAVING clause in the outer query contains 
          an operator other than one of the operators that are specified above, 
          the query will fail. An error message is displayed in the SAS log, which 
          indicates that the subquery evaluated to more than one row. For example, 
          if you use the equal (=) operator with a noncorrelated subquery that 
          returns multiple values, the query will fail. The equal operator can 
          handle only a single value.</p>
        </td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td><p>Let's first look at a query that contains both the conditional operator 
          IN and a noncorrelated subquery that returns multiple values. (The operators 
          ANY, ALL, and EXISTS are presented later in this lesson.)</p>
        <br>
        <h2>Example</h2>
        <p>Suppose you want to send birthday cards to employees who have birthdays 
          coming up. You decide to create a PROC SQL query that will list the 
          names and addresses of all employees who have birthdays in February. 
          This query, unlike the one shown on the previous page, will select data 
          from two different tables:</p>
        <ul>
          <li> employee names and addresses in the table <strong>Sasuser.Staffmaster</strong></li>
          <li> employee birth dates in the table <strong>Sasuser.Payrollmaster</strong>. 
          </li>
        </ul>
        <p>In both tables, the employees are identified by their employee identification 
          number (<code>EmpID</code>). </p>
        <p>In the following PROC SQL query, the WHERE clause contains the conditional 
          operator IN followed by a noncorrelated subquery:</p></td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td> <pre><font color="#003399">     proc sql;
        select empid, lastname, firstname, 
               city, state
           from sasuser.staffmaster
           where empid <strong>in</strong>
              <strong>(select empid
                 from sasuser.payrollmaster
                 where month(dateofbirth)=2)</strong>;</font></pre></td>
    </tr>
  </table>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td><p>This query is processed as follows:</p>
        <ol>
          <li>To complete the expression in the WHERE clause of the outer query, 
            the subquery selects the employees whose date of birth is February. 
            Note that the MONTH function is used in the subquery.<br>
            <br>
          </li>
          <li>The subquery then returns the <code>EmpID</code> values of the selected 
            employees to the outer query. <br>
            <br>
          </li>
          <li>The outer query displays data (from the columns identified in the 
            SELECT clause) for the employees identified by the subquery.</li>
        </ol>
        <p>The output, shown below, lists the six employees who have February 
          birthdays.</p></td>
    </tr>
  </table>
  <p><br>
  <TABLE  cellspacing=1 cellpadding=2 rules=GROUPS frame=BOX border=1 bgcolor="#FFFFF0" bordercolor="#000000" title="PROC SQL Output">
    <thead>
      <TR> 
        <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>EmpID</b></font></TD>
        <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>LastName</b></font></TD>
        <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>FirstName</b></font></TD>
        <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>City</b></font></TD>
        <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>State</b></font></TD>
      </TR>
    </thead>
    <tbody>
      <TR> 
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">1403</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">BOWDEN</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">EARL</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">BRIDGEPORT</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">CT</font></TD>
      </TR>
      <TR> 
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">1404</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">CARTER</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">DONALD</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NEW 
          YORK</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NY</font></TD>
      </TR>
      <TR> 
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">1834</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">LONG</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">RUSSELL</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NEW 
          YORK</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NY</font></TD>
      </TR>
      <TR> 
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">1103</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">MCDANIEL</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">RONDA</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NEW 
          YORK</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NY</font></TD>
      </TR>
      <TR> 
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">1420</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">ROUSE</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">JEREMY</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">PATERSON</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NJ</font></TD>
      </TR>
      <TR> 
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">1390</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">SMART</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">JONATHAN</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NEW 
          YORK</font></TD>
        <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">NY</font></TD>
      </TR>
    </tbody>
  </TABLE>
  <p><br>
  <!-- InstanceEndEditable --> 
</center>
<script>writeNav_regular_bottom();</script>
</body>
<!-- InstanceEnd --></html>
