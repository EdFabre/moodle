<html><!-- InstanceBegin template="/Templates/informationObject.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<SCRIPT LANGUAGE="JavaScript" SRC="../tut.js"></SCRIPT>
<script language="JavaScript" src="../nav.js"></script>
<SCRIPT LANGUAGE="JavaScript">
 setPageTitle();
 setCookie();
  
// Drop down menu link- © Dynamic Drive (www.dynamicdrive.com)
// For full source code and 100's more DHTML scripts, visit http://www.dynamicdrive.com
// Credit MUST stay intact for use -->

</SCRIPT>

<!-- InstanceBeginEditable name="extrascript" -->
<SCRIPT LANGUAGE="JavaScript">
</SCRIPT>
<!-- InstanceEndEditable -->

<link rel="stylesheet" href="../tut.css">


<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
</HEAD>

<body marginheight="0" marginwidth="0" topmargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFF0">
<script>writeinformationObjectTopNav1();</script>
	  
	  <font color="#003399" size="3" face="Arial, Helvetica, sans-serif"><strong><!-- InstanceBeginEditable name="TopicTitle" -->Comparing 
      DATA Step Match-Merges and PROC SQL Joins<!-- InstanceEndEditable --></strong></font> <!-- InstanceBeginEditable name="continued" --><font color="#003399" size="3" face="Arial, Helvetica, sans-serif">(continued)</font><!-- InstanceEndEditable -->
	  
<script>writeinformationObjectTopNav2();</script>
<br>
<center>
  <!-- InstanceBeginEditable name="content" --> 
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td>Earlier in this lesson, you learned that a DATA step match-merge will 
        probably not produce the desired results when the data sources that you 
        want to combine have a many-to-many match. You also learned that PROC 
        SQL and the DATA step match-merge do not, by default, produce the same 
        results when you are combining data sources that contain nonmatching data. 
        Now that you have seen how DATA step match-merges and PROC SQL joins work, 
        let's take a look at an example of using each of these techniques to combine 
        data from a many-to-many match that also contains nonmatching data. 
        <p><br><h2>Example: Combining Data from a Many-to-Many Match</h2>
        <p>Suppose you want to combine the data from <strong>Sasuser.Flightschedule</strong> 
          and <strong>Sasuser.Flightattendants</strong>. The <strong>Sasuser.Flightschedule</strong> 
          data set contains information about flights that have been scheduled 
          for a fictional airline. The data set <strong>Sasuser.Flightattendants</strong> 
          contains information about the flight attendants of a fictional airline. 
          A partial listing of each of these data sets is shown below. </p>
		  <p><br>
	<center>Sasuser.Flightschedule (Partial Listing)</center>
        <TABLE  Border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
  <thead>
    <TR> 
      <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>Date</b></font></TD>
      <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>Destination</b></font></TD>
      <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>FlightNumber</b></font></TD>
      <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>EmpID</b></font></TD>
    </TR>
  </thead>
  <tbody>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">132</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1739</font></TD>
    </TR>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">132</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1478</font></TD>
    </TR>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">132</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1130</font></TD>
    </TR>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">132</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1390</font></TD>
    </TR>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">132</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1983</font></TD>
    </TR>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">132</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1111</font></TD>
    </TR>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">182</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1076</font></TD>
    </TR>
    <TR> 
      <TD ALIGN=RIGHT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">01MAR2000</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">YYZ</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">182</font></TD>
      <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1118</font></TD>
    </TR>
  </tbody>
</TABLE><P><BR>
	        <center>
            Sasuser.Flightattendants (Partial Listing) 
          </center>
              <TABLE  Border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
  <thead>
    <TR> 
                    <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>EmpID</b></font></TD>
                    <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>JobCode</b></font></TD>
                    <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>LastName</b></font></TD>
                    <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#F7F7DE"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>FirstName</b></font></TD>
    </TR>
  </thead>
  <tbody>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1350</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA3</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Arthur</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Barbara</font></TD>
    </TR>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1574</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA2</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Cahill</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Marshall</font></TD>
    </TR>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1437</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA3</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Carter</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Dorothy</font></TD>
    </TR>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1988</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA3</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Dean</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Sharon</font></TD>
    </TR>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1983</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA2</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Dunlap</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Donna</font></TD>
    </TR>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1125</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA2</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Eaton</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Alicia</font></TD>
    </TR>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1475</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA1</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Fields</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Diana</font></TD>
    </TR>
    <TR> 
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">1422</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">FA1</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Fletcher</font></TD>
                    <TD ALIGN=LEFT bgcolor="#FFFFFF"><font  face="Verdana, Arial, Helvetica" size="2" color="#000000">Marie</font></TD>
    </TR>
  </tbody>
</TABLE>
		  <p><br>
        <p>Suppose you want to combine all variables from the <strong>Sasuser.Flightschedule</strong> 
          data set with the first and last names of each flight attendant who 
          is scheduled to work on each flight. <strong>Sasuser.Flightschedule</strong> 
          contains data for 45 flights, and three flight attendants are scheduled 
          to be on each flight. Therefore, your output data set should contain 
          135 observations (three for each flight).</p>
        <p>You could use the following PROC SQL step to combine <strong>Sasuser.Flightschedule</strong> 
          with <strong>Sasuser.Flightattendants</strong>. <font color="#003399">
        <pre>     proc sql;
        create table flightemps as
           select flightschedule.*, firstname, lastname
              from sasuser.flightschedule, sasuser.flightattendants
                 where flightschedule.empid=flightattendants.empid;
     quit;</pre>
        </font>
        <p> The <a href="JavaScript: openOther('m56_23a.htm')">resulting <strong>Flightemps</strong> data set</a> contains 135 observations.</p>
        <p> Now, suppose you use the following DATA step match-merge to combine 
          these two data sets. <font color="#003399"> </font></p>
        <font color="#003399">
        <pre>     proc sort data=sasuser.flightattendants out=fa;
        by empid;
     run;
	 
     proc sort data=sasuser.flightschedule out=fs;
        by empid;
     run;
	 
     data flightemps2;
        merge fa fs;
        by empid;
     run;</pre>
        </font> The <a href="JavaScript: openOther('m56_23b.htm')">resulting <strong>Flightemps2</strong> 
        data set</a> contains 272 observations. The DATA step match-merge does 
        not produce the correct results because it combines the data sequentially. 
        In the correct results, there are three observations for each unique flight 
        from <strong>Sasuser.Flightschedule</strong>, and there are no missing 
        values in any of the observations. By contrast, the results from the DATA 
        step match-merge contain six observations for each unique flight and many 
        observations that have missing values.</td>
    </tr>
  </table>
 
  <p><br>
  <!-- InstanceEndEditable --> 
</center>
<script>writeNav_regular_bottom();</script>
</body>
<!-- InstanceEnd --></html>
