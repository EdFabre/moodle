<html><!-- InstanceBegin template="/Templates/informationObject.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<SCRIPT LANGUAGE="JavaScript" SRC="../tut.js"></SCRIPT>
<script language="JavaScript" src="../nav.js"></script>
<SCRIPT LANGUAGE="JavaScript">
 setPageTitle();
 setCookie();
  
// Drop down menu link- © Dynamic Drive (www.dynamicdrive.com)
// For full source code and 100's more DHTML scripts, visit http://www.dynamicdrive.com
// Credit MUST stay intact for use -->

</SCRIPT>

<!-- InstanceBeginEditable name="extrascript" -->
<SCRIPT LANGUAGE="JavaScript">
</SCRIPT>
<!-- InstanceEndEditable -->

<link rel="stylesheet" href="../tut.css">


<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
</HEAD>

<body marginheight="0" marginwidth="0" topmargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFF0">
<script>writeinformationObjectTopNav1();</script>
	  
	  <font color="#003399" size="3" face="Arial, Helvetica, sans-serif"><strong><!-- InstanceBeginEditable name="TopicTitle" -->Comparing 
      SQL Joins and DATA Step Match-Merges<!-- InstanceEndEditable --></strong></font> <!-- InstanceBeginEditable name="continued" --><!-- InstanceEndEditable -->
	  
<script>writeinformationObjectTopNav2();</script>
<br>
<center>
  <!-- InstanceBeginEditable name="content" --> 
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td> <p>You should be familiar with the use of the DATA step to merge data 
          sets. DATA step match-merges and PROC SQL joins can produce the same 
          results. However, there are important differences between these two 
          techniques. For example, a join does not require that you sort the data 
          first; a DATA step match-merge requires that the data be sorted.</p>
        <p> Let&#8217;s compare the use of SQL joins and DATA step match-merges 
          in the following situations:</p>
        <ul>
          <li> when <strong>all</strong> of the values of the selected variable 
            (column) match</li>
          <li> when <strong>only some</strong> of the values of the selected variable 
            (column) match.</li>
        </ul>
        <h2> <br>
          When All of the Values Match</h2>
        <p> When <strong>all</strong> of the values of the BY variable match, 
          you can use a <strong>PROC SQL inner join</strong> to produce the <strong>same 
          results</strong> as a DATA step match-merge.</p>
        <p> Suppose you want to combine the tables <strong>One</strong> and <strong>Two</strong>, 
          as shown below.<br>
        </p></td>
    </tr>
  </table>
  <p><br>
  <table border="0" align="center" cellspacing="10">
    <tr> 
      <td align="center" valign="top"> One 
        <table  border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
          <thead>
            <tr align="center" valign="top"> 
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>X</b></font></td>
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>A</b></font></td>
            </tr>
          </thead>
          <tbody>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">1</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">a</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">2</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">b</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">3</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">c</font></td>
            </tr>
          </tbody>
        </table></td>
      <td align="center" valign="top"> Two 
        <table  border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
          <thead>
            <tr align="center" valign="top"> 
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>X</b></font></td>
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>B</b></font></td>
            </tr>
          </thead>
          <tbody>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">1</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">x</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">2</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">y</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">3</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">z</font> 
              </td>
            </tr>
          </tbody>
        </table></td>
    </tr>
  </table>
  <p>
  <br>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td>These two tables have the column <code>X</code> in common, and all values 
        of <code>X</code> in each row match across the two tables. Both tables 
        are already sorted by <code>X</code>. </td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td>The following DATA step match-merge (followed by a PROC PRINT step) 
        and the PROC SQL inner join produce identical reports.</td>
    </tr>
  </table>
  <p>
  <br>
  <table border="0" align="center" cellspacing="10">
    <tr> 
      <td align="left" valign="top"> <div align="center"><strong>DATA Step Match-Merge 
          </strong> </div>
        <pre><font color="#003399">data merged;
   merge one two;
   by x;
run;

proc print data=merged noobs;
   title 'Table Merged';
run;</font></pre></td>
      <td align="left" valign="top"><div align="center"><strong>PROC SQL Inner 
          Join </strong> </div>
        <pre><font color="#003399">proc sql;
title 'Table Merged';
   select one.x, a, b
      from one, two
      where one.x = two.x
      order by x;</font></pre></td>
    </tr>
  </table>
  <table border="0" align="center" cellspacing="10">
    <tr> 
      <td align="center" valign="top"> One 
        <table  border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
          <thead>
            <tr align="center" valign="top"> 
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>X</b></font></td>
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>A</b></font></td>
            </tr>
          </thead>
          <tbody>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">1</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">a</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">2</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">b</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">3</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">c</font></td>
            </tr>
          </tbody>
        </table></td>
      <td align="center" valign="top"> Two 
        <table  border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
          <thead>
            <tr align="center" valign="top"> 
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>X</b></font></td>
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>B</b></font></td>
            </tr>
          </thead>
          <tbody>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">1</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">x</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">2</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">y</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">3</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">z</font> 
              </td>
            </tr>
          </tbody>
        </table></td>
    </tr>
  </table>
  <br>
  <TABLE  cellspacing=1 cellpadding=1 rules=NONE frame=VOID border=0 width=100%>
    <TR> 
      <TD ALIGN=CENTER><font color="#002288" size="4"  face="Arial, Helvetica, Helv"><b><i>Table 
        Merged </i></b></font></TD>
    </TR>
  </TABLE>
  <br>
  <TABLE border=1 align="center" cellpadding=2  cellspacing=1 bordercolor="#000000" bgcolor="#FFFFF0" frame=BOX rules=GROUPS title="PROC SQL Output">
    <thead>
      <TR align="center" valign="top"> 
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>X</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>A</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><strong>B</strong></font></TD>
      </TR>
    </thead>
    <tbody>
      <TR align="center" valign="top"> 
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">1</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">a</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">x</font></TD>
      </TR>
      <TR align="center" valign="top"> 
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">2</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">b</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">y</font></TD>
      </TR>
      <TR align="center" valign="top"> 
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">3</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">c</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">z</font></TD>
      </TR>
    </tbody>
  </TABLE>
  <p>
  <br>
  <table width="85%" border="0" align="center" cellpadding="2" cellspacing="0">
    <tr> 
      <td valign="top" width="24"><img src="../navimages/note.gif" width="20" height="20" alt="Note"></td>
      <td valign="top">The DATA step match-merge creates a data set whereas the 
        PROC SQL inner join, as shown here, creates only a report as output. To 
        make these two programs completely identical, the PROC SQL inner join 
        could be rewritten to create a table. For detailed information about creating 
        tables with PROC SQL, see the lesson 
        <!--lesson reference-->
        <strong> 
        <script>document.write(m73title);</script></strong>. </td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" align="center" cellpadding="2" cellspacing="0">
    <tr> 
      <td valign="top" width="24"><img src="../navimages/note.gif" width="20" height="20" alt="Note"></td>
      <td valign="top">If the order of rows in the output does not matter, the 
        ORDER BY clause can be removed from the PROC SQL join. Without the ORDER 
        BY clause, this join is more efficient, because PROC SQL does not need 
        to make a second pass through the data.</td>
    </tr>
  </table>
  <p>
  <br>
  <!-- InstanceEndEditable --> 
</center>
<script>writeNav_regular_bottom();</script>
</body>
<!-- InstanceEnd --></html>
