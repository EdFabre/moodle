<html><!-- InstanceBegin template="/Templates/informationObject.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<SCRIPT LANGUAGE="JavaScript" SRC="../tut.js"></SCRIPT>
<script language="JavaScript" src="../nav.js"></script>
<SCRIPT LANGUAGE="JavaScript">
 setPageTitle();
 setCookie();
  
// Drop down menu link- © Dynamic Drive (www.dynamicdrive.com)
// For full source code and 100's more DHTML scripts, visit http://www.dynamicdrive.com
// Credit MUST stay intact for use -->

</SCRIPT>

<!-- InstanceBeginEditable name="extrascript" -->
<SCRIPT LANGUAGE="JavaScript">
</SCRIPT>
<!-- InstanceEndEditable -->

<link rel="stylesheet" href="../tut.css">


<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
</HEAD>

<body marginheight="0" marginwidth="0" topmargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFF0">
<script>writeinformationObjectTopNav1();</script>
	  
	  <font color="#003399" size="3" face="Arial, Helvetica, sans-serif"><strong><!-- InstanceBeginEditable name="TopicTitle" -->Using 
      Inner Joins<!-- InstanceEndEditable --></strong></font> <!-- InstanceBeginEditable name="continued" --><font color="#003399" size="3" face="Arial, Helvetica, sans-serif">(continued)</font><!-- InstanceEndEditable -->
	  
<script>writeinformationObjectTopNav2();</script>
<br>
<center>
  <!-- InstanceBeginEditable name="content" --> 
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td> <p>By default, PROC SQL joins do <strong>not</strong> overlay columns 
          with the same name. Instead, the output displays <strong>all</strong> 
          columns that have the same name. To avoid having columns with the same 
          name in the output from an inner or outer join, you can eliminate or 
          rename the duplicate columns.<br>
        </p></td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" cellpadding="2" cellspacing="0">
    <tr> 
      <td valign="top" width="24"><img src="../navimages/tip.gif" width="20" height="20" alt="More Information"></td>
      <td valign="top">You can also use the COALESCE function with an inner or 
        outer join to overlay columns with the same name. The COALESCE function 
        is discussed, along with outer joins, later in this lesson.</td>
    </tr>
  </table>
  <p><br>
  <table cellpadding="0" cellspacing="0" border="0" width="85%">
    <tr> 
      <td> <h2>Eliminating Duplicate Columns</h2>
        <p> Let&#8217;s return to the sample PROC SQL query that uses an inner 
          join to combine the tables <strong>One</strong> and <strong>Two</strong>:</p></td>
    </tr>
  </table>
  <p><br>
  <table border="0" align="center" cellspacing="10">
    <tr> 
      <td valign="top"> <pre><font color="#003399">proc sql;
   select *
      from one, two
      where one.x = two.x;</font></pre></td>
      <td align="center" valign="top"> One 
        <table  border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
          <thead>
            <tr align="center" valign="top"> 
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2"><b>X</b></font></td>
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>A</b></font></td>
            </tr>
          </thead>
          <tbody>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">1</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">a</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">2</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">b</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">4</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">d</font></td>
            </tr>
          </tbody>
        </table></td>
      <td align="center" valign="top"> Two 
        <table  border=1 align="center" cellpadding=3 cellspacing=0 bgcolor="#CCCCCC" frame=BOX title="SAS Data Set">
          <thead>
            <tr align="center" valign="top"> 
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2"><b>X</b></font></td>
              <td width="40" bgcolor="#F7F7DE"><font face="Verdana, Arial, Helvetica" size="2" color="#000000"><b>B</b></font></td>
            </tr>
          </thead>
          <tbody>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">2</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">x</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">3</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">y</font></td>
            </tr>
            <tr valign="top"> 
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">5</font></td>
              <td align=center bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica" size="2" color="#000000">v</font> 
              </td>
            </tr>
          </tbody>
        </table></td>
    </tr>
  </table>
  <br>
  <TABLE border=1 align="center" cellpadding=2  cellspacing=1 bordercolor="#000000" bgcolor="#FFFFF0" frame=BOX rules=GROUPS title="PROC SQL Output">
    <thead>
      <TR align="center" valign="top"> 
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>X</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>A</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>X</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>B</b></font></TD>
      </TR>
    </thead>
    <tbody>
      <TR align="center" valign="top"> 
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">2</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">b</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">2</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">x</font></TD>
      </TR>
    </tbody>
  </TABLE>
  <p> <br>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td><p>The two tables have a column with an identical name (<code>X</code>). 
          Because the SELECT clause in the query shown above contains an asterisk, 
          the output displays <strong>all</strong> columns from <strong>both</strong> 
          tables. </p>
        <p>To eliminate a duplicate column, you can specify just one of the duplicate 
          columns in the SELECT statement. The SELECT statement in the preceding 
          PROC SQL query can be modified as follows: </p></td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td><pre><font color="#003399">     proc sql;
        select <strong><font color="red">one.x</font></strong>, a, b
           from one, two
           where one.x = two.x</font></pre></td>
    </tr>
  </table>
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td> <p>Here, the SELECT clause specifies that only the column <code>X</code> 
          from table <strong>One</strong> will be included in output. The output, 
          which now displays only one column <code>X</code>, is shown below.<br>
        </p></td>
    </tr>
  </table>
  <p> <br>
  <TABLE border=1 align="center" cellpadding=2  cellspacing=1 bordercolor="#000000" bgcolor="#FFFFF0" frame=BOX rules=GROUPS title="PROC SQL Output">
    <thead>
      <TR align="center" valign="top"> 
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>X</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>A</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>B</b></font></TD>
      </TR>
    </thead>
    <tbody>
      <TR align="center" valign="top"> 
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">2</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">b</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">x</font></TD>
      </TR>
    </tbody>
  </TABLE>
  <p><br>
  <table width="85%" border="0" align="center" cellpadding="2" cellspacing="0">
    <tr> 
      <td valign="top" width="24"><img src="../navimages/note.gif" width="20" height="20" alt="Note"></td>
      <td valign="top">In an inner equijoin, like the one shown here, it does 
        not matter which of the same-named columns is listed in the SELECT statement. 
        The SELECT statement in this example could have specified <code>Two.X</code> 
        instead of <code>One.X</code>.</td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td><p>Another way to eliminate the duplicate <code>X</code> column in the 
          preceding example is shown below: </p></td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td><pre><font color="#003399">     proc sql;
        select <font color="red"><strong>one.*</strong></font>, b
           from one, two
           where one.x = two.x;</font></pre></td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td> <p>By using the asterisk (*) to select <strong>all</strong> columns 
          from table <strong>One</strong>, and only <strong><code>B</code></strong> 
          from table <strong>Two</strong>, this query generates the same output 
          as the preceding version.</p>
        <p><br>
        <h2> <a name="alias"></a>Renaming a Column by Using a Column Alias</h2>
        <p> If you are working with several tables that have a column with a common 
          name but slightly different data, you might want <strong>both</strong> 
          columns to appear in output. To avoid the confusion of displaying two 
          different columns with the same name, you can rename one of the duplicate 
          columns by specifying a column alias in the SELECT statement. For example, 
          you could modify the SELECT statement of the sample query as follows:<br>
        </p></td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td> <pre><font color="#003399">     proc sql;
        select <strong>one.x <font color="red">as ID</font>, two.x</strong>, a, b
           from one, two
           where one.x = two.x;</font></pre> 
      </td>
    </tr>
  </table>
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td> <p>The output of the modified query is shown here.<br>
        </p></td>
    </tr>
  </table>
  <p> <br>
  <TABLE border=1 align="center" cellpadding=2  cellspacing=1 bordercolor="#000000" bgcolor="#FFFFF0" frame=BOX rules=GROUPS title="PROC SQL Output">
    <thead>
      <TR align="center" valign="top"> 
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>ID</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>X</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>A</b></font></TD>
        <TD width="40" bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>B</b></font></TD>
      </TR>
    </thead>
    <tbody>
      <TR align="center" valign="top"> 
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">2</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">2</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">b</font></TD>
        <TD bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2">x</font></TD>
      </TR>
    </tbody>
  </TABLE>
  <p> <br>
  <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td>Now that the column <code>One.X</code> has been renamed to ID, the output 
        clearly indicates that <code>ID</code> and <code>X</code> are two different 
        columns.</td>
    </tr>
  </table>
  <p><br>
  <!-- InstanceEndEditable --> 
</center>
<script>writeNav_regular_bottom();</script>
</body>
<!-- InstanceEnd --></html>
