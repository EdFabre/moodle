<html><!-- InstanceBegin template="/Templates/informationObject.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<SCRIPT LANGUAGE="JavaScript" SRC="../tut.js"></SCRIPT>
<script language="JavaScript" src="../nav.js"></script>
<SCRIPT LANGUAGE="JavaScript">
 setPageTitle();
 setCookie();
  
// Drop down menu link- © Dynamic Drive (www.dynamicdrive.com)
// For full source code and 100's more DHTML scripts, visit http://www.dynamicdrive.com
// Credit MUST stay intact for use -->

</SCRIPT>

<!-- InstanceBeginEditable name="extrascript" -->
<SCRIPT LANGUAGE="JavaScript">
</SCRIPT>
<!-- InstanceEndEditable -->

<link rel="stylesheet" href="../tut.css">


<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
</HEAD>

<body marginheight="0" marginwidth="0" topmargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFF0">
<script>writeinformationObjectTopNav1();</script>
	  
	  <font color="#003399" size="3" face="Arial, Helvetica, sans-serif"><strong><!-- InstanceBeginEditable name="TopicTitle" -->Inserting 
      Rows of Data to a Table<!-- InstanceEndEditable --></strong></font> <!-- InstanceBeginEditable name="continued" --><font color="#003399" size="3" face="Arial, Helvetica, sans-serif">(continued)</font><!-- InstanceEndEditable -->
	  
<script>writeinformationObjectTopNav2();</script>
<br>
<center>
  <!-- InstanceBeginEditable name="content" --> 
  <table width="85%" border="0" cellpadding="0" cellspacing="0">
    <tr valign="top"> 
      <td> <h2>Inserting Rows from a Query Result</h2>
        <p> The fastest way to insert rows of data into a table is to use a query 
          to select existing rows from one or more tables (or views) and to insert 
          the rows into another table. You can insert rows from a query result 
          into either an empty table or a table that already contains rows of 
          data. When you add rows of data to a table that already contains rows, 
          the new rows are added at the end of the table. </p>
        <p>To insert rows from a query result, use an <strong>INSERT statement</strong> 
          that includes the <strong>clauses that are used in a query</strong>: 
          SELECT, FROM, and any optional clauses, such as ORDER BY. Values from 
          the query result are inserted into columns in the order in which the 
          columns appear in the table or, if an optional column list is specified, 
          in the order that the columns appear in that list.<br>
        </p></td>
    </tr>
  </table>
  <p><br>
  <table width="85%" border="1" align="center" cellpadding="10" cellspacing="0" bgcolor="#F7F7DE" title="General form, INSERT statement containing query clauses">
    <tr> 
      <td align="left"><p><strong>General form, INSERT statement containing query 
          clauses:</strong> </p>
        <blockquote><font color="#003399"><strong>INSERT INTO</strong> <em>table-name</em> 
          </font><font color="#003399"><em>&lt;(target-column-1&lt;, ... target-column-n</em>)&gt;</font><br>
          <font color="#003399">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#003399"><strong>SELECT</strong> 
          <em>column-1&lt;, ... column-n</em>&gt;<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>FROM</strong> 
          <em>table-1 | view-1&lt;, ... table-n | view-n&gt;</em><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<em>optional 
          query clauses&gt;</em><strong>;</strong> </font> </p></blockquote>
        <p> where </p>
        <ul>
          <li><font color="#003399"><em>table-name</em></font> specifies the name 
            of the table to which rows will be inserted.</li>
          <li><em><font color="#003399">target-column</font></em> specifies the 
            name of a column into which data will be inserted.</li>
          <li><strong><font color="#003399">SELECT</font></strong> specifies the 
            column(s) that will be inserted.</li>
          <li><strong><font color="#003399">FROM</font></strong> specifies the 
            table(s) or view(s) to be queried.</li>
          <li><em><font color="#003399">optional query clauses</font></em> are 
            used to refine the query further. These include the WHERE, GROUP BY, 
            HAVING, and ORDER BY clauses.</li>
        </ul>
        <table border="0" cellpadding="2" cellspacing="0">
          <tr> 
            <td valign="top" width="24"><img src="../navimages/note.gif" width="20" height="20" alt="Note"></td>
            <td valign="top"><p>It is optional to include a list of target column 
                names after the table name in the INSERT TABLE statement that 
                includes query clauses. The list can include the names of all 
                or only a subset of columns in the table. If an optional list 
                of target column names is specified, then only those columns are 
                given values by the statement. Target columns may be listed in 
                any order, regardless of their position in the table. Any columns 
                that are in the table but <strong>not</strong> listed are given 
                missing values in the inserted rows.</p></td>
          </tr>
        </table></td>
    </tr>
  </table>
  <p><br>
  <table cellpadding="0" cellspacing="0" border="0" width="85%">
    <tr> 
      <td><h2> Example</h2>
        <p> A mechanic at a company has been promoted from level 2 to level 3, 
          and you need to add this employee to <strong>Sasuser.Mechanicslevel3</strong>, 
          a table that lists all level-3 mechanics. To start, let's create a temporary 
          copy of <strong>Sasuser.Mechanicslevel3</strong> called <strong>Work.Mechanicslevel3_New</strong>, 
          and display the new table in a report:</p></td>
    </tr>
  </table>
  <br>
  <table cellpadding="0" cellspacing="0" border="0" width="85%">
    <tr> 
      <td><pre>     <font color="#003399">proc sql;
        create table work.mechanicslevel3_new as
           select *
              from sasuser.mechanicslevel3;</font></pre></td>
    </tr>
  </table>
  <p><font  face="Arial, Helvetica, Helv" size="2" color="#002288"> </font>
  <CENTER>
    <font  face="Arial, Helvetica, Helv" size="2" color="#002288"> 
    <TABLE  cellspacing=1 cellpadding=2 rules=GROUPS frame=BOX border=1 bgcolor="#FFFFF0" bordercolor="#000000" title="PROC SQL Output">
      <thead>
        <TR> 
          <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>EmpID</b></font></TD>
          <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>JobCode</b></font></TD>
          <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>Salary</b></font></TD>
        </TR>
      </thead>
      <tbody>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1499</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$60,235</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1409</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$58,171</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1379</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$59,170</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1521</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$58,136</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1385</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$61,460</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1420</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$60,299</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1882</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$58,153</font></TD>
        </TR>
      </tbody>
    </TABLE>
    </font> 
  </CENTER>
  <p><br>
  <table cellpadding="0" cellspacing="0" border="0" width="85%">
    <tr> 
      <td><p>Next, you insert a row into <strong>Work.Mechanicslevel3_New</strong> 
          for the new level-3 employee, whose <code>EmpID</code> is <em>1653</em>. 
          This employee is currently listed in <strong>Sasuser.Mechanicslevel2</strong>, 
          so your INSERT statement queries the table <strong>Sasuser.Mechanicslevel2</strong>. 
          Your PROC SQL step ends with a SELECT statement that outputs the revised 
          table <strong>Work.Mechanicslevel3_New</strong> to a report.</p></td>
    </tr>
  </table>
  <br>
  <table cellpadding="0" cellspacing="0" border="0" width="85%">
    <tr> 
      <td><pre><font color="#003399">     proc sql; 
        <strong>insert</strong> into work.mechanicslevel3_new
           <strong>select</strong> empid, jobcode, salary 
              from sasuser.mechanicslevel2
              where empid='1653';
        select *
           from work.mechanicslevel3_new;</font></pre></td>
    </tr>
  </table>
  <br>
  <CENTER>
    <font  face="Arial, Helvetica, Helv" size="2" color="#002288"> 
    <TABLE  cellspacing=1 cellpadding=2 rules=GROUPS frame=BOX border=1 bgcolor="#FFFFF0" bordercolor="#000000" title="PROC SQL Output">
      <thead>
        <TR> 
          <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>EmpID</b></font></TD>
          <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>JobCode</b></font></TD>
          <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#003399"><b>Salary</b></font></TD>
        </TR>
      </thead>
      <tbody>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1499</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$60,235</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1409</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$58,171</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1379</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$59,170</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1521</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$58,136</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1385</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$61,460</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1420</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$60,299</font></TD>
        </TR>
        <TR> 
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1882</font></TD>
          <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME3</font></TD>
          <TD ALIGN=RIGHT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$58,153</font></TD>
        </TR>
        <TR bgcolor="#ffff9c"> 
          <TD ALIGN=LEFT><font  face="Arial, Helvetica, Helv" size="2" color="#000000">1653</font></TD>
          <TD ALIGN=LEFT><font  face="Arial, Helvetica, Helv" size="2" color="#000000">ME2</font></TD>
          <TD ALIGN=RIGHT><font  face="Arial, Helvetica, Helv" size="2" color="#000000">$49,151</font></TD>
        </TR>
      </tbody>
    </TABLE>
    </font> 
  </CENTER>
  <p><br>
  <table cellpadding="0" cellspacing="0" border="0" width="85%">
    <tr> 
      <td><p>The row that you have inserted into <strong>Work.Mechanicslevel3_New</strong> 
          is highlighted above. As you can see, the values for <code>JobCode</code> 
          and <code>Salary</code> for the new employee will have to be changed. 
          Updating existing values in a table is covered later in this lesson.</p></td>
    </tr>
  </table>
  <br>
  <table width="85%" border="0" cellpadding="2" cellspacing="0">
    <tr> 
      <td valign="top" width="24"><img src="../navimages/note.gif" width="20" height="20" alt="Note"></td>
      <td valign="top">Although the new row is shown here at the bottom of the 
        table, the order of rows in a PROC SQL query cannot be guaranteed if an 
        ORDER BY clause is not used.</td>
    </tr>
  </table>
  <p>&nbsp; <!-- InstanceEndEditable --> 
</center>
<script>writeNav_regular_bottom();</script>
</body>
<!-- InstanceEnd --></html>
