<html><!-- InstanceBegin template="/Templates/informationObject.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<SCRIPT LANGUAGE="JavaScript" SRC="../tut.js"></SCRIPT>
<script language="JavaScript" src="../nav.js"></script>
<SCRIPT LANGUAGE="JavaScript">
 setPageTitle();
 setCookie();
  
// Drop down menu link- © Dynamic Drive (www.dynamicdrive.com)
// For full source code and 100's more DHTML scripts, visit http://www.dynamicdrive.com
// Credit MUST stay intact for use -->

</SCRIPT>

<!-- InstanceBeginEditable name="extrascript" --> 
<SCRIPT LANGUAGE="JavaScript">
</SCRIPT>
<!-- InstanceEndEditable -->

<link rel="stylesheet" href="../tut.css">


<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
</HEAD>

<body marginheight="0" marginwidth="0" topmargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFF0">
<script>writeinformationObjectTopNav1();</script>
	  
	  <font color="#003399" size="3" face="Arial, Helvetica, sans-serif"><strong><!-- InstanceBeginEditable name="TopicTitle" -->Using 
      Macro Functions to Manipulate Character Strings<!-- InstanceEndEditable --></strong></font> <!-- InstanceBeginEditable name="continued" --><font color="#003399" size="3" face="Arial, Helvetica, sans-serif">(continued)</font><!-- InstanceEndEditable -->
	  
<script>writeinformationObjectTopNav2();</script>
<br>
<center>
  <!-- InstanceBeginEditable name="content" --> 
<table width="85%" border="0" cellpadding="0" cellspacing="0" align="center">
  <tr valign="top"> 
    <td>
<h2>The %SCAN Function</h2>

The <nobr>%SCAN</nobr> function enables you to extract words from the value of 
        a macro variable. </td>
    </tr></table><P><BR>
 <table border="1" cellspacing="0" cellpadding="10" width="85%" bgcolor="#F7F7DE" align="center" title="General form, %SCAN function">
    <tr> 
      <td align="left"><strong>General form, %SCAN function:</strong> 
        <blockquote> <nobr><font color="#003399"><strong>%SCAN </strong>( <em>argument 
          </em>, <em>n</em> <,<em>delimiters</em>> ) </font></nobr> 
        </blockquote>
        <p> where 
        <ul>
	<li><font color="#003399"><em>argument</em></font> consists of constant text, macro variable references, 
	macro functions, or macro calls.
          <li><font color="#003399"><em>n</em></font> is an integer or a text expression that yields an integer, 
	which specifies the position of the word to return. If <font color="#003399"><em>n</em></font> is greater 
	than the number of words in <font color="#003399"><em>argument</em></font>,
	the functions return a null string. 
	<li><font color="#003399"><em>delimiters</em></font> specifies an optional list of one or more characters 
	that separate "words" or text expressions that yield one or more characters. 
         
        </ul>
<table cellpadding="2">
        <tr valign="Top">
            <td width="24" valign="top"><img border="0" width="37" height="32" src="../navimages/alert.gif" alt="Caution:"></td>
          <td>If <font color="#003399"><em>argument</em></font> contains a comma, you must enclose 
	<font color="#003399"><em>argument</em></font> in a quoting function. Similarly, in order to use a 
	single blank or a single comma as the only <font color="#003399"><em>delimiter</em></font>, you must enclose the 
	character in the <nobr>%STR</nobr> function.
</td>
        </tr>
      </table> 
      </td>
    </tr>
  </table>

<P><BR>

<table width="85%" border="0" cellpadding="0" cellspacing="0" align="center">
  <tr>     
    <td>The delimiters that <nobr>%SCAN</nobr> recognizes vary between ASCII and EBCDIC systems. 
	If you omit delimiters, SAS treats the following characters as <strong>default delimiters</strong>: 
<ul>
<li>
ASCII systems: <code>blank . < ( + & ! $ * ) ; ^ - / , % |</code> 
<li>
EBCDIC systems: <code>blank . < ( + | & ! $ * ) ; ¬ - / , % ¦ ¢ </code>
</ul>


If <em>delimiters</em> includes any of the default delimiters for your system, the remaining default delimiters 
are treated as text. 

</td>
  </tr>
</table>
<P><BR>
<table width="85%" border="0" cellpadding="0" cellspacing="0" align="center">
  <tr valign="top"> 
    <td>
<h2>Example</h2>
 You can use PROC DATASETS along with the <nobr>%SCAN</nobr> function and the <code>SYSLAST</code> 
          macro variable to investigate the structure of the most recently created 
          data set:<font color="#003399">
        <PRE>    data work.thisyear;
       set sasuser.schedule;
       where year(begin_date) =
             year(&quot;&amp;sysdate9&quot;d);
    run;

    <strong>%let libref=%scan(&amp;syslast,1,.);
    %let dsname=%scan(&amp;syslast,2,.);</strong>
    proc datasets lib=&amp;libref nolist;
    title &quot;Contents of the Data Set &amp;syslast&quot;;
       contents data=&amp;dsname;
    run;
    quit;
</PRE>
        </font>

<P>
    </td></tr></table>
<center>
<CENTER>
<font  face="Arial, Helvetica, Helv" size="3" color="#002288"> 
<TABLE  cellspacing=0 cellpadding=0 rules=NONE frame=VOID border=0 width=100% bgcolor="#E0E0E0">
<TR>
 <TD ALIGN=CENTER bgcolor="#FFFFF0"><font  face="Arial, Helvetica, Helv" size="4" color="#002288"><b><em>Contents of the Data Set WORK.THISYEAR                        </em></b></font></TD>
</TR>
</TABLE>
</font></CENTER>

<CENTER>
<font  face="Arial, Helvetica, Helv" size="3" color="#002288"> 
<TABLE  cellspacing=0 cellpadding=0 rules=NONE frame=VOID border=0 width=100% bgcolor="#E0E0E0">
<TR>
 <TD ALIGN=CENTER bgcolor="#FFFFF0"><font  face="Arial, Helvetica, Helv" size="4" color="#002288"><b><em>The DATASETS Procedure</em></b></font></TD>
</TR>
</TABLE>
</font></CENTER>
<P>
<CENTER>
<font  face="Arial, Helvetica, Helv" size="2" color="#002288"> 
<TABLE  title="SAS output" cellspacing=1 cellpadding=2 rules=GROUPS frame=BOX border=1 bgcolor="#FFFFFF" bordercolor="#000000">
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Data Set Name</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">WORK.THISYEAR</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Observations</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">4</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Member Type</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">DATA</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Variables</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">5</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Engine</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">V9</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Indexes</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">0</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Created</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">15:33 Thursday, June 27, 2002</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Observation Length</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">48</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Last Modified</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">15:33 Thursday, June 27, 2002</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Deleted Observations</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">0</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Protection</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">&nbsp;</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Compressed</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">NO</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Data Set Type</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">&nbsp;</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Sorted</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">NO</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Label</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">&nbsp;</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>&nbsp;</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">&nbsp;</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Data Representation</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">WINDOWS</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>&nbsp;</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">&nbsp;</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>Encoding</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">wlatin1  Western (Windows)</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Arial, Helvetica, Helv" size="3" color="#0033AA"><b>&nbsp;</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#EFEFEF"><font  face="Arial, Helvetica, Helv" size="2" color="#000000">&nbsp;</font></TD>
</TR>
</tbody>
</TABLE>
</font></CENTER></center><P><BR>


<!-- InstanceEndEditable --> 
</center>
<script>writeNav_regular_bottom();</script>
</body>
<!-- InstanceEnd --></html>
