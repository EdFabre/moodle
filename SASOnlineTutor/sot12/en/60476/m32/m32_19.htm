<html><!-- InstanceBegin template="/Templates/informationObject.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<SCRIPT LANGUAGE="JavaScript" SRC="../tut.js"></SCRIPT>
<script language="JavaScript" src="../nav.js"></script>
<SCRIPT LANGUAGE="JavaScript">
 setPageTitle();
 setCookie();
  
// Drop down menu link- © Dynamic Drive (www.dynamicdrive.com)
// For full source code and 100's more DHTML scripts, visit http://www.dynamicdrive.com
// Credit MUST stay intact for use -->

</SCRIPT>

<!-- InstanceBeginEditable name="extrascript" --> 
<SCRIPT LANGUAGE="JavaScript">
</SCRIPT>
<!-- InstanceEndEditable -->

<link rel="stylesheet" href="../tut.css">


<META http-equiv="Content-Type" content="text/html; charset=windows-1252">
</HEAD>

<body marginheight="0" marginwidth="0" topmargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFF0">
<script>writeinformationObjectTopNav1();</script>
	  
	  <font color="#003399" size="3" face="Arial, Helvetica, sans-serif"><strong><!-- InstanceBeginEditable name="TopicTitle" -->Creating 
      Your Own Macro Variables<!-- InstanceEndEditable --></strong></font> <!-- InstanceBeginEditable name="continued" --><font color="#003399" size="3" face="Arial, Helvetica, sans-serif">(continued)</font><!-- InstanceEndEditable -->
	  
<script>writeinformationObjectTopNav2();</script>
<br>
<center>
  <!-- InstanceBeginEditable name="content" --> 
<table width="85%" border="0" cellpadding="0" cellspacing="0" align="center">
  <tr valign="top"> 
      <td> 
        <p>Now that you are familiar with the %LET statement, let's create the macro 
        variable for your program about temporary employees. Remember, you need 
        to create a macro variable to contain the year value. </p>
      <pre><font color="#003399">     title 'Temporary Employees for 1999';</font>
<font color="#003399">     data hrd.newtemp;</font>
<font color="#003399">        set hrd.temp;</font>
<font color="#003399">        if year(enddate)=1999;</font>
<font color="#003399">     run;</font>
<font color="#003399">     proc print data=hrd.newtemp;</font>
<font color="#003399">     run;</font>
</pre>
      <p> Your first report is about temporary employees who were hired in 1999, 
        so you write the %LET statement as follows: 
      <pre><font color="#003399">     %let year=1999;</font>
</pre>
      <p> After defining a macro variable, you need to reference the macro variable 
        in your program. Referencing a user-defined macro variable is the same 
        as referencing an automatic macro variable. You specify the macro variable 
        name preceded by an ampersand. 
      <pre><font color="#003399">     &amp;year</font>
</pre>
      <p> Here's your revised program. The %LET statement defines your macro variable, 
        and the macro variable references appear throughout the program statements. 
      <pre><font color="#003399">     <strong>%let year=1999;</strong></font>
<font color="#003399">     title </font><font color="Red">"</font><font color="#003399">Temporary Employees for <strong>&amp;year</strong></font><font color="Red">"</font><font color="#003399">;</font>
<font color="#003399">     data hrd.newtemp;</font>
<font color="#003399">        set hrd.temp;</font>
<font color="#003399">        if year(enddate)=<strong>&amp;year</strong>;</font>
<font color="#003399">     run;</font>
<font color="#003399">     proc print data=hrd.newtemp;</font>
<font color="#003399">     run;</font>
</pre>
      <p> Notice the placement of the %LET statement. This statement must appear 
        before the macro variable references. Typically, the %LET statement is 
        placed at the beginning of the program. 
      <p> After you submit the program, the macro variable references are resolved 
        by replacing each reference with the macro variable value. Macro variable 
        references are resolved before the DATA step is compiled. 
      <p> For example, consider your subsetting IF statement:
      <pre><font color="#003399">     if year(enddate)=&amp;year;</font>
</pre>
      <p> The statement is processed by SAS as follows: 
      <pre><font color="#003399">     if year(enddate)=<strong>1999</strong>;</font>
</pre>
      <p> After your program compiles successfully, the program statements are 
        executed, your data set is created, and you see the following PROC PRINT 
        output.
    </td>
  </tr>
</table>
<p> 
<center>
  <br>
  <table border=0 width=85% cellpadding=1 cellspacing=1 rules=NONE frame=VOID>
    <tr> 
      <td align=CENTER><font face="Arial, Helvetica, Helv" size="4" color="#002288"><b><i><nobr>Temporary 
        Employees for 1999</nobr></i></b></font></td>
    </tr>
  </table>
</center>
<p> 
<center>
  <font face="Arial, Helvetica, Helv" size="3" color="#002288"></font> 
  <table border=1 cellpadding=2 cellspacing=1 rules=GROUPS frame=BOX bgcolor="#FFFFF0"
    bordercolor="#000000" title="PROC PRINT output">
    <thead> 
    <tr> 
      <td align=CENTER bgcolor="#CCCCCC" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="3" color="#0033AA"><b>Obs</b></font></td>
      <td align=LEFT bgcolor="#CCCCCC" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="3" color="#0033AA"><b>Agency</b></font></td>
      <td align=LEFT bgcolor="#CCCCCC" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="3" color="#0033AA"><b>ID</b></font></td>
      <td align=LEFT bgcolor="#CCCCCC" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="3" color="#0033AA"><b>Name</b></font></td>
    </tr>
    </thead> <tbody> 
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        1</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000"><nobr>Administrative Support, Inc. </nobr></font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">F274</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">CICHOCK, ELIZABETH MARIE </font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        2</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">Administrative Support, Inc. </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">F101</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">BENINCASA, HANNAH LEE</font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        3</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">OD Consulting, Inc. </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">F054</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">SHERE, BRIAN THOMAS</font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        4</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">New Time Temps Agency </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">F077</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">HODNOFF, RICHARD LEE</font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        5</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">Administrative Support, Inc. </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">P039</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">CHEVARLEY, ARLENE ELSIE</font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        6</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">New Time Temps Agency </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">P378</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">LAMUTU, JULIE HOPE </font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        7</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">Temporary Services, Inc. </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">F462</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000"><nobr>AMAKIAN, DOROTHY ELIZABETH&nbsp;</nobr></font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        8</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">Administrative Support, Inc. </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">F015</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">LAMUTO, JULIE HOPE</font></td>
    </tr>
    <tr> 
      <td align=RIGHT bgcolor="#CCCCCC" bordercolor="#000000"><b><font face="Arial, Helvetica, Helv" size="3" color="#003399"> 
        9</font></b></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">New Time Temps Agency </font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">P524</font></td>
      <td align=LEFT bgcolor="#EFEFEF" bordercolor="#000000"><font face="Arial, Helvetica, Helv"
		size="2" color="#000000">ABRAMSON, ANDREA CARLSON</font></td>
    </tr>
    </tbody> 
  </table>
  <center>
    <br>
    <br>
    <table cellpadding=0 cellspacing=0 border=0 width="85%">
      <tr> 
        <td>Now that your program contains a macro variable, it will be easy to 
          update each year. You simply change the value of the macro variable 
          <code>year</code>, and your program is ready to use. 
          <pre><font color="#003399">     %let year=<strong>2000</strong>;</font>
<font color="#003399">     title "Temporary Employees for &amp;year";</font>
<font color="#003399">     data hrd.newtemp;</font>
<font color="#003399">        set hrd.temp;</font>
<font color="#003399">        if year(enddate)=&amp;year;</font>
<font color="#003399">     run;</font>
<font color="#003399">     proc print data=hrd.newtemp;</font>
<font color="#003399">     run;</font>
</pre>
        </td>
      </tr>
    </table>
  </center>
</center>
<!-- InstanceEndEditable --> 
</center>
<script>writeNav_regular_bottom();</script>
</body>
<!-- InstanceEnd --></html>
